module tinf_test @test;

import tinf;

fn void inflate_huffman_only()
{
	// 256 zero bytes compressed using Huffman only (no match or distance codes)
	char[*] data = {
		0x05, 0xCA, 0x81, 0x00, 0x00, 0x00, 0x00, 0x00, 0x10, 0xFF,
		0xD5, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
		0x00, 0x00, 0x00, 0x00, 0x02
	};

	char[256] out;
	int dlen = data.len;

	tinf::uncompress(out[..], &dlen, data[..], data.len)!!;

	assert(dlen == data.len);
	assert(out[:data.len] == data[..]);
}
